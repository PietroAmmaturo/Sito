<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Advanced Hello World A-Frame WebXR</title>
  <meta name="description"
        content="Advanced Hello World, WebXR! A-frame provides a hello world that is really remarkable, however you usually need to have controller selection and environment with movement.  With this example you get what works across the most headsets and controllers.">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0, shrink-to-fit=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="gray-translucent" />
  <!-- *** CHANGE THESE TO COMPONENTS ON YOUR SERVER *** -->
  <script src="scripts/aframe.min.js"></script>
  <script src="scripts/aframe-extras.min.js"></script>
  <script src="scripts/aframe-teleport-controls.min.js"></script>
  <script src="scripts/aframe-thumb-controls-component.min.js"></script>
  <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
  <!-- for creating Navmesh... Also uncomment a-scene inspector-plugin-recast
    <script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
    -->

</head>

<body>

  <!-- used for creating Navmesh... see javascript component above <a-scene inspector-plugin-recast>  https://github.com/donmccurdy/aframe-inspector-plugin-recast-->
  <a-scene background="color: #FAFAFA">

    <!-- assets to load -->
    <a-assets>
			<a-asset-item id="structure-obj" src="assets/obj/SECRET PROJECT X3.obj"></a-asset-item>
            <a-asset-item id="structure-mtl" src="assets/obj/SECRET PROJECT X3.mtl"></a-asset-item>
		</a-assets>

    <!-- main structure -->
    <a-entity class="collision" obj-model="obj: #structure-obj; mtl: #structure-mtl" shadow="cast: true; receive: true" position = "0 0 0" scale="1 1 1" ></a-entity>
    <!-- nav-mesh: protecting us from running thru sphere, cube and cylinder  -->
    <a-entity id="navmesh" gltf-model="assets/gltf/navmesh.gltf" visible="true" nav-mesh>

      <a-circle id="start" position="0 1.6 -5" class="clickable" start color="#000000">
      </a-circle>

      <a-circle id="start" position="3 1.6 2" class="clickable" start color="#000000">
      </a-circle>
    </a-entity>
    <!-- Basic movement and teleportation  -->
    <a-entity id="cameraRig" movement-controls="constrainToNavMesh: true;"
              navigator="cameraRig: #cameraRig; cameraHead: #head; collisionEntities: .collision; ignoreEntities: .clickable"
              position="0 0 0" rotation="0 0 0">
      <!-- camera -->
      <a-entity id="head" camera="active: true" position="0 1.6 0"
                look-controls="pointerLockEnabled: true; reverseMouseDrag: true"></a-entity>
      <!-- Left Controller  -->
      <a-entity class="leftController" hand-controls="hand: left; handModelStyle: lowPoly; color: #15ACCF"
                tracked-controls vive-controls="hand: left" oculus-touch-controls="hand: left"
                windows-motion-controls="hand: left"
                visible="true">			
                <a-entity id="cursor" raycaster="showLine: true; far: 10; interval: 0; objects: .clickable, a-link;"
                animation__click="property: scale; startEvents: click; easing: easeInCubic; dur: 150; to: 1 1 1"
                animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 1500; to: 3 3 3"
                animation__leaving="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 250; to: 1 1 1"
                cursor="fuse: true; fuseTimeout: 1500" material="color: white; shader: flat"
                position="0 0 0" geometry="primitive: sphere; radius: 1">
          </a-entity>
        </a-entity>
      <!-- Right Controller  -->
      <a-entity class="rightController" hand-controls="hand: right; handModelStyle: lowPoly; color: #15ACCF"
                tracked-controls vive-controls="hand: right" oculus-touch-controls="hand: right"
                windows-motion-controls="hand: right" laser-controls
                teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head; button: trigger; type: parabolic; curveShootingSpeed: 18; collisionEntities: #navmesh; landingMaxAngle: 60"
                line="color: lawngreen; opacity: 0.5" visible="true"></a-entity>
    </a-entity>
    <!-- A light in the scene casting shadows -->
    <a-entity light="intensity: 0.6; castShadow: true; shadowCameraLeft: -10; shadowCameraBottom: -10; shadowCameraRight: 10; shadowCameraTop: 10; shadowCameraVisible: true"
              position="9.9649 17.32329 13.93447"></a-entity>
  </a-scene>
  <script>
    		AFRAME.registerComponent('start',
			{
				init: function () {
					console.log("registered");
					var el = this.el;
					el.setAttribute("animation__start-click2", "property: scale; startEvents: click; easing: easeInCubic; dur: 2000; to: 0 0 0");
					el.setAttribute("animation__start-fusing", "property: opacity; startEvents: fusing; easing: easeInCubic; dur: 1500; from: 1; to: 0.9");
					el.setAttribute("event-set__pop-click", "_event: click; class: unclickable;");
				}
			});

  </script>
</body>

</html>